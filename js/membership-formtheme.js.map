{"version":3,"sources":["membership-formtheme.js"],"names":["CRM","$","append","payment_processor_ids","form_name","$form","length","$niceForm","prepend","parseStdCiviField","selector","$rowNode","find","hide","rtn","label","input","parseSelect2CiviField","$select","killSelect2","select2","removeClass","addClass","parseComplexCiviField","parseRadiosIntoSelect","on","prop","each","$originalInput","$option","attr","value","text","next","e","preventDefault","click","$selectFix","createStdFields","$label","fields","$appendTo","$container","buildStdContainer","console","error","yourInformation","a","b","first_name","last_name","email","phone","alterPaymentMethodsAvailable","donateAmountLayout","$amount","$blurb","amount","membershipAmountButtons","$priceset","map","selectedOption","showButtonAsSelected","$btn","parent","siblings","forEach","m","is","whyJoining","html","$payment_processor_selection_ui","$payment_processor_switch_wrapper","paymentDetails","$paymentDetails","$header","$content","selectPaymentMethod","selected_processor_id","val","log","GoCardless","indexOf","giftAid","$gaRow","$inputs","$yes","eq","$yes_label","$no","$no_label","$helpRow","$intro","slice","$declaration","add","remove","$layout","$inputs_container","gdprFields","$gdpr","$niceGdpr","renameSubmitButton","$submitButtonWrapper","$niceSubmitButton","trigger","$original_billing_payment_block","watchPaymentFields","wrapper","config","childList","subtree","delayed","vitiligoTweakDynamicPaymentFields","observer","disconnect","$billingBlock","vtTweaksDone","$billingAddressSection","after","wrap","themeRadiosAndCheckboxes","join","fadeIn","observe","callback","mutationsList","needToTweakUi","mutation","target","id","window","clearTimeout","setTimeout","MutationObserver","$context","$input","$wrapper","before","findPaymentProcessorRadioForProcessorType","processorType","processorIds","found","match","selected_uk","vt_payment","ddProcessor"],"mappings":"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","file":"membership-formtheme.js","sourcesContent":["((CRM, $) => $(() => {\n\n'use strict';\n\n  // Bodge for now: @todo\n  $('head').append('<link href=\"https://fonts.googleapis.com/css?family=Arimo\" rel=\"stylesheet\">');\n\n  // The config placeholder here is replaced by php. Do not alter the line below at all.\n  var payment_processor_ids = {};//%config%\n  var form_name = '';//%formname%\n\n  var $form = $('form#Main');\n  if (!$form.length) {\n    return;\n  }\n\n  const $niceForm = $('<div/>');\n  $form.prepend($niceForm);\n\n  function parseStdCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n\n    const rtn = {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content input'),\n    };\n    if (rtn.input.length === 0) {\n      rtn.input = $rowNode.find('div.content textarea');\n    }\n    return rtn;\n  }\n  function parseSelect2CiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    var $select = $rowNode.find('select');\n    return {\n      label: $rowNode.find('div.label label'),\n      input: killSelect2($select)\n    };\n  }\n  function killSelect2($select) {\n    return $('<div class=\"vt-select-container\"/>').append(\n      $select.select2('destroy').removeClass('crm-select2 crm-chain-select-target crm-form-select').addClass('vt-select')\n    );\n  }\n  function parseComplexCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content').removeClass('content'),\n    };\n  }\n  function parseRadiosIntoSelect(selector) {\n    var $rowNode = $form.find(selector).hide();\n    const $select = $('<select class=\"vt-select\" />');\n    $select.append(\n      $('<option value=\"\">--Please select--</option>')\n      .on('click', function() { $rowNode.find('input:checked').prop('checked', false); }));\n    $rowNode.find('input[type=\"radio\"]').each(function() {\n      const $originalInput = $(this);\n      $option = $('<option/>').attr('value', this.value).text($originalInput.next('label').text())\n      .on('click', e => { e.preventDefault(); $originalInput.click(); } );\n      $select.append($option);\n    });\n\n    const $selectFix = $('<div class=\"vt-select-container\" />').append($select);\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $selectFix,\n    };\n  }\n  function createStdFields($label, fields, $appendTo) {\n    const $container = buildStdContainer($label, fields);\n    $niceForm.append($container);\n  }\n  function buildStdContainer($label, fields) {\n    const $container = $('<div class=\"vt-container vt-grid1\"></div>');\n\n    if ($label) {\n      $container.append($('<div class=\"vt-label vt-col-1 vt-colspan-1\"></div>').append($label));\n    }\n\n    if (fields.length === 1) {\n      $container.append($('<div class=\"vt-input vt-col-2-span-2\"></div>').append(fields[0]));\n    }\n    else if (fields.length === 2) {\n      $container.append($('<div class=\"vt-input vt-col-2\"></div>').append(fields[0]));\n      $container.append($('<div class=\"vt-input vt-col-3\"></div>').append(fields[1]));\n    }\n    else {\n      console.error(\"fields must be 1 or two big.\", fields);\n    }\n    return $container;\n  }\n\n  function yourInformation() {\n    var a, b;\n    $niceForm.append('<div class=\"vt-your-info\"><h2>Your information</h2><span>*Required fields</span></div>');\n\n    // Add name fields.\n    var first_name = parseStdCiviField('#editrow-first_name');\n    first_name.label.text('Full Name');\n    first_name.input.attr('placeholder', 'First name');\n    var last_name = parseStdCiviField('#editrow-last_name');\n    last_name.input.attr('placeholder', 'Last name');\n    createStdFields(first_name.label, [first_name.input, last_name.input]);\n\n    // Add email\n    var email = parseStdCiviField('#editrow-email-1');\n    email.input.attr('placeholder', 'Email');\n    createStdFields(email.label, [email.input]);\n\n    // Add phone\n    var phone = parseStdCiviField('#editrow-phone-Primary-1');\n    phone.input.attr('placeholder', 'Phone number');\n    phone.label.text('Phone number');\n    createStdFields(phone.label, [phone.input]);\n\n    // address.\n    $niceForm.append('<hr/>');\n    a = parseStdCiviField('#editrow-street_address-Primary');\n    a.label.text('Your address');\n    a.input.attr('placeholder', 'Address line 1*');\n    createStdFields(a.label, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-supplemental_address_1-Primary');\n    a.input.attr('placeholder', 'Address line 2*');\n    createStdFields(null, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-city-Primary');\n    a.input.attr('placeholder', 'Town/City');\n    b = parseSelect2CiviField('#editrow-state_province-Primary');\n    createStdFields(null, [a.input, b.input]);\n    // ...\n    a = parseStdCiviField('#editrow-postal_code-Primary');\n    a.input.attr('placeholder', 'Postcode*');\n    b = parseSelect2CiviField('#editrow-country-Primary');\n    createStdFields(null, [a.input, b.input]);\n    // We also need to hook up the country selector to the payment selector logic.\n    b.input.find('select').on('change', alterPaymentMethodsAvailable);\n\n\n    $niceForm.append('<hr/>');\n    // DOB\n    a = parseComplexCiviField('#editrow-birth_date');\n    a.input.find('.crm-clear-link').hide();\n    createStdFields(a.label, [a.input, null]);\n\n    // Ethnicity\n    a = parseSelect2CiviField('#editrow-custom_14');\n    b = parseStdCiviField('#editrow-custom_15');\n    b.input.attr('placeholder', 'Other'); // Q. how to be reactive to an existing select2 element? @todo\n    createStdFields(a.label, [a.input, b.input]);\n\n    a = parseRadiosIntoSelect('#editrow-gender_id');\n    createStdFields(a.label, [a.input, null]);\n\n    // Do you have Vitiligo.\n    a = parseRadiosIntoSelect('#editrow-custom_16');\n    createStdFields(a.label, [a.input, null]);\n\n  }\n  function donateAmountLayout() {\n    const $container = $('<div class=\"vt-container vt-donation-layout\"></div>');\n    const $amount = $('<div class=\"vt-donation-amount-wrapper\"></div>');\n    const $blurb = $(`<div class=\"vt-donation-amount-blurb\">\n      <div class=\"vt-donation-amount-blurb-header\">\n        <div class=\"vt-donation-blurb-title\">\n          <i class=\"vt-icon vt-icon--member\"></i>\n          Membership is the best way to support us\n        </div>\n        <a class=\"vt-donation-blurb-readmore\" href=\"/membership\" >Read more</a>\n      </div>\n      <div class=\"vt-donation-amount-blurb-text\">\n        <p>This copy will explain what their membership contribution does. Apparently it's 3-4 paragraphs, which is a lot.</p>\n        <p>Apparently it's 3-4 paragraphs, which is a lot. This copy will explain what their membership contribution does. </p>\n        <p>Apparently it's 3-4 paragraphs, which is a lot.</p>\n      </div>\n    </div>`);\n    const amount = parseStdCiviField('.other_amount-section');\n    $amount.append('<h3 class=\"vt-heading\" >Your donation</h3>',\n      amount.label.text('I would like to give'),\n      $('<div class=\"vt-donation-amount-input-wrapper\"/>').append(amount.input)\n      );\n    $container.append($amount, $blurb);\n    $niceForm.append($container);\n  }\n  function membershipAmountButtons() {\n    var a, b;\n    var $priceset = $('#priceset').hide();\n    // @todo match these with price set ids.\n    const map = [\n      ['#price_7_7', '£25'],\n      ['#price_7_a', '£50'],\n      ['#price_7_b', '£100'],\n      ['#price_7_c', '£250'],\n      ['#price_7_d', '£500'],\n    ];\n    const $container = $('<div class=\"vt-container vt-amount-buttons\"></div>');\n    // @todo set defaults.\n    var selectedOption;\n    function showButtonAsSelected($btn) {\n      $btn.addClass('selected').parent().siblings().find('button').removeClass('selected');\n    }\n    map.forEach(m => {\n      const $btn = $('<button/>')\n        .attr('data-input-selector', m[0])\n        .text(m[1])\n        .on('click', function(e) {\n          e.preventDefault();\n          $(m[0]).click();\n          showButtonAsSelected($(this));\n        });\n      $container.append(\n        $('<div class=\"vt-amount-buttons__button\"></div>')\n        .append($btn)\n      );\n      if ($(m[0]).is(':checked')) {\n        selectedOption= m[0];\n      }\n    });\n    if (!selectedOption) {\n      // @todo set this to actual default price set id.\n      // Nb. might be different for membership/donation.\n      selectedOption = '#price_7_b';\n    }\n    // Initial show selected button.\n    showButtonAsSelected($container.find('button[data-input-selector=\"' + selectedOption + '\"]'));\n\n    $niceForm.append('<h3 class=\"vt-heading vt-heading--smaller-grey1\">My contribution</h3>');\n    $niceForm.append($container);\n    $niceForm.append('<hr/>');\n  }\n  function whyJoining() {\n    var a, b;\n    a = parseStdCiviField('#editrow-custom_17');\n    a.label.html(\"<h3 class='vt-heading'>Why are you signing up to membership with the Vitiligo Society?</h3>\");\n    $niceForm.append($('<div class=\"vt-container\"/>').append(a.label, a.input), '<hr/>');\n  }\n  const $payment_processor_selection_ui = $form.find(\"fieldset.payment_options-group\");\n  var $payment_processor_switch_wrapper; // set in paymentDetails()\n  function paymentDetails() {\n    $payment_processor_selection_ui.hide();\n\n    const $paymentDetails = $('<div class=\"vt-payment-box\"/>');\n    const $header = $(`<div class=\"vt-payment-box__header\">\n      <div class=\"vt-payment-box__gbp\"><i class=\"vt-icon vt-icon--gbp-circle\"></i></div>\n      <h3 class=\"vt-payment-box__heading\">Your payment details</h3>\n      <div class=\"vt-payment-box__payby\">Pay by:</div>\n      <div class=\"vt-payment-box__switch-container\">\n        <div class=\"vt-payment-box__switch-wrapper\">\n          <label class=\"vt-payment-box__dd\" for=\"CIVICRM_QFID_11_payment_processor_id\">Direct Debit</label>\n          <label class=\"vt-payment-box__c\" for=\"CIVICRM_QFID_9_payment_processor_id\">Card</label>\n        </div>\n      </div>\n      `);\n    const $content = $('<div class=\"vt-payment-box__content\"/>');\n    $payment_processor_switch_wrapper = $header.find('.vt-payment-box__switch-wrapper');\n    $paymentDetails.append($header, $content);\n    $content.append($form.find('#billing-payment-block'));\n    $payment_processor_selection_ui.find('input').on('click', selectPaymentMethod);\n    $payment_processor_switch_wrapper.find('label').on('click', selectPaymentMethod);\n    $niceForm.append($paymentDetails);\n    alterPaymentMethodsAvailable();\n    selectPaymentMethod();\n  }\n  function selectPaymentMethod() {\n    const selected_processor_id = $payment_processor_selection_ui.find('input:checked').val();\n    console.log(\"selectPaymentMethod running \", selected_processor_id);\n    if (payment_processor_ids.GoCardless.indexOf(selected_processor_id) > -1) {\n      $payment_processor_switch_wrapper.addClass('selected-dd').removeClass('selected-c');\n    }\n    else {\n      $payment_processor_switch_wrapper.addClass('selected-c').removeClass('selected-dd');\n    }\n  }\n  function giftAid() {\n    //editrow-custom_10\n    const $gaRow = $('#editrow-custom_10');\n    const $inputs = $gaRow.find('input');\n    const $yes = $inputs.eq(0);\n    const $yes_label = $yes.next();\n    const $no = $inputs.eq(1);\n    const $no_label = $no.next();\n    const $helpRow = $('#helprow-custom_10>div');\n    const $intro = $helpRow.find('>p').slice(3,5);\n    const $declaration = $helpRow.find('p').eq(0).add($helpRow.find('ol').eq(0));\n\n    // Remove the remaining help text.\n    $helpRow.remove();\n\n    // Remove the third input (\"Yes, in the past 4 years\")\n    $inputs.eq(2).parent().parent().remove();\n\n    // Now re-assemble.\n    const $container = $('<div class=\"vt-container\"></div>');\n    $container.append('<h3 class=\"vt-heading\">Gift Aid</h3>', $intro);\n    // Now the grid layout\n    const $layout = $('<div class=\"vt-giftaid-layout-1\"/>');\n    const $inputs_container = $('<div class=\"vt-giftaid-inputs\" />');\n    $inputs_container.append($yes, $yes_label, $no, $no_label);\n    $layout.append($inputs_container, $('<div class=\"vt-giftaid-declaration\"/>').append($declaration));\n    $container.append($layout);\n    $niceForm.append($container, '<hr/>');\n\n  }\n  function gdprFields() {\n    const $gdpr = $('#gdpr-terms-conditions');\n    const $niceGdpr = $('<div class=\"vt-gdpr\"></div>');\n    $niceGdpr.append($('<div class=\"vt-gdpr__text\"/>').append('<h2>Terms and conditions</h2>', $gdpr.find('.terms-conditions-acceptance-intro')));\n\n    $niceGdpr.append($gdpr.find('.terms-conditions-item'));\n\n    $niceForm.append($niceGdpr);\n    $gdpr.remove();\n  }\n  function renameSubmitButton(text) {\n    // Hide the original button, make a new button which clicks it by JS.\n    const $submitButtonWrapper = $form.find('#crm-submit-buttons input').parent().hide();\n\n    const $niceSubmitButton = $('<button class=\"vt-submit\"/>')\n      .text(text)\n      .on('click', e => {e.preventDefault();$submitButtonWrapper.find('input[type=\"submit\"]').trigger('click');});\n\n    $niceForm.append($niceSubmitButton);\n  }\n  /**\n   * We need to look out for changes that are interactively made by CiviCRM.\n   */\n  // CiviCRM ends up creating nested versions of this :-(\n  // So make a reference to the original.\n  const $original_billing_payment_block = $('#billing-payment-block');\n  function watchPaymentFields() {\n    const wrapper = $original_billing_payment_block[0];\n    const config = { childList: true, subtree: true };\n    var delayed = false;\n\n    // This function deals with re-presenting card payment fields in the billing-payment-block\n    const vitiligoTweakDynamicPaymentFields = function() {\n      observer.disconnect();\n      console.log(\"Tweaking form ...\");\n\n      // Reconfigure payment block.\n      // Remove the non-unique id from the billing-payment-block.\n      $original_billing_payment_block.find('#billing-payment-block').attr('id', 'nested-billing-payment-block');\n      const $billingBlock = $original_billing_payment_block;\n      if ($billingBlock[0].vtTweaksDone) {\n        console.log(\"Already tweaked it.\");\n      }\n      $billingBlock[0].vtTweaksDone = true;\n      // We'll use this existing container for the address fields.\n      const $billingAddressSection = $billingBlock.find('.billing_name_address-section');\n\n      $billingBlock.find('.credit_card_number-section').after(\n        $('<div class=\"direct-debit-benefits-para\"><div class=\"dashed\" ><i class=\"vt-icon vt-icon--info\"></i>Para on benefits of DD.</div><i class=\"vt-icon vt-icon--padlock\"></i></div>')\n      );\n      // Strip out some CiviCRM classes that give us grief.\n      $billingBlock.find('.crm-section').removeClass('crm-section');\n      $billingBlock.find('div.label').removeClass('label').addClass('vt-payment-label');\n      $billingBlock.find('div.content').removeClass('content').addClass('vt-container');\n      $billingBlock.find('.clear').remove();\n\n\n      // Re-class the selects.\n      $billingBlock.find('#credit_card_exp_date_M, #credit_card_exp_date_Y')\n        .addClass('vt-select')\n        .wrap('<div class=\"vt-select-container vt-card-expiry\"/>');\n\n      // If we have a billingAddressSection we need to theme that now.\n      if ($billingAddressSection.length) {\n        // ... add a title and move the 'same as above' checkbox.\n        $billingAddressSection.append('<h2>Your billing information</h2>',\n          $billingBlock.find('#billingcheckbox'),\n          $billingBlock.find('label[for=\"billingcheckbox\"]')\n        );\n        // Theme the \"My billing address is same...\"\n        themeRadiosAndCheckboxes($billingAddressSection);\n\n        // Move the Name fields.\n        $billingAddressSection.append(buildStdContainer(\n          $billingBlock.find('.billing_first_name-section label').text('Name on card'),\n          [\n            $billingBlock.find('.billing_first_name-section input'),\n            $billingBlock.find('.billing_last_name-section input'),\n          ]\n        ));\n\n        // Move Street addres.,\n        $billingAddressSection.append(buildStdContainer(\n          $billingBlock.find('.billing_street_address-5-section label').text('Address'),\n          [$billingBlock.find('.billing_street_address-5-section input').attr('placeholder', 'Address line 1*')]\n        ));\n\n        // Move City., county.\n        $billingAddressSection.append(buildStdContainer(\n          null,\n          [\n            $billingBlock.find('.billing_city-5-section input').attr('placeholder', 'Town/City'),\n            killSelect2($billingBlock.find('.billing_state_province_id-5-section select'))\n          ]\n        ));\n\n        // Move Post code, country.\n        $billingAddressSection.append(buildStdContainer(\n          null,\n          [\n            $billingBlock.find('.billing_postal_code-5-section input').attr('placeholder', 'Postcode'),\n            killSelect2($billingBlock.find('.billing_country_id-5-section select'))\n          ]\n        ));\n\n        // Hide left over crud.\n        $billingBlock.find([\n          '.billing_first_name-section',\n          '.billing_middle_name-section',\n          '.billing_last_name-section',\n          '.billing_street_address-5-section',\n          '.billing_city-5-section',\n          '.billing_state_province_id-5-section',\n          '.billing_postal_code-5-section',\n          '.billing_country_id-5-section',\n        ].join(',')).hide();\n      }\n\n\n      console.log(\"End tweaks. Showing payment block again and reconnecting observer\");\n      $original_billing_payment_block.fadeIn('fast');\n      observer.observe(wrapper, config);\n    };\n\n    // This callback is used in the mutation observer.\n    // Its job is to identify if a DOM mutation is relevant to the billing payment block.\n    // If so it will call vitiligoTweakDynamicPaymentFields after half a second.\n    const callback = function(mutationsList, observer) {\n      var needToTweakUi = false;\n      for(var mutation of mutationsList) {\n\t\t\t\t// We need to detect whether the change was the payment block.\n\t\t\t\tif (mutation.target.id == 'billing-payment-block') {\n          needToTweakUi = true;\n\t\t\t\t}\n      }\n\n      if (needToTweakUi) {\n        console.log(\"Found billing-payment-block in mutation targets\", mutationsList);\n        // Note CiviCRM ends up creating nested #billing-payment-block elements :-(\n\n        // Hide the element while we build this and mess it around.\n        $original_billing_payment_block.hide();\n\n        // If already queued, requeue with new delay.\n        if (delayed) {\n          window.clearTimeout(delayed);\n          delayed = false;\n        }\n        // Allow some time for things to settle.\n        delayed = window.setTimeout(vitiligoTweakDynamicPaymentFields, 500);\n      }\n    };\n\n    // Create an observer instance linked to the callback function\n    const observer = new MutationObserver(callback);\n\n    // Start observing the target node for configured mutations\n    observer.observe(wrapper, config);\n  }\n  function themeRadiosAndCheckboxes($context) {\n    $context.find('input[type=\"radio\"], input[type=\"checkbox\"]').each(function() {\n      const $input = $(this);\n      if ($input.is('.vt-themed')) {\n        return;\n      }\n      const $label = $input.next();\n      const $wrapper = $('<div class=\"vt-checkbox-radio-wrapper\"/>');\n      if ($input.is('input[type=\"checkbox\"]')) {\n        $wrapper.addClass('checkbox');\n      }\n      else {\n        $wrapper.addClass('radio');\n      }\n      $input.before($wrapper);\n      $wrapper.append($input, $label);\n      $input.addClass('vt-themed');\n    });\n  }\n  // Returns DOM node.\n  function findPaymentProcessorRadioForProcessorType(processorType) {\n    var processorIds = payment_processor_ids[processorType] || [];\n\n    var found;\n    $('fieldset.payment_options-group [name=\"payment_processor_id\"]').each(function() {\n      var m =this.id.match(/CIVICRM_QFID_(\\d+)_payment_processor_id$/);\n      if (m && m.length === 2 && processorIds.indexOf(m[1])>-1) {\n        found = this;\n      }\n    });\n\n    return found;\n  }\n  function alterPaymentMethodsAvailable() {\n    const selected_uk = 'United Kingdom' === $('#country-Primary option:selected').text();\n    const selected_processor_id = $form.find('fieldset.payment_options-group input:checked').val();\n    const vt_payment = $('.vt-payment-box');\n    const ddProcessor = $(findPaymentProcessorRadioForProcessorType('GoCardless'));\n    if (selected_uk) {\n      // Allow DD and Card.\n      vt_payment.removeClass('disable-dd');\n    }\n    else {\n      // Disable DD payments.\n      vt_payment.addClass('disable-dd');\n      // If currently selected processor is DD then do the change now.\n      if (ddProcessor.is(':checked')) {\n        // Need to change it.\n        $(findPaymentProcessorRadioForProcessorType('Stripe')).click();\n        selectPaymentMethod();\n      }\n    }\n    // Now disable DD radio input unless in uk.\n    // This is done for accessibility reasons - visual users will already not\n    // have a way to select those.\n    $(ddProcessor).prop('disabled', !selected_uk);\n  }\n\n  if (form_name === 'membership') {\n\n    membershipAmountButtons();\n    yourInformation();\n    whyJoining();\n    paymentDetails();\n    giftAid();\n    gdprFields();\n    renameSubmitButton('Join');\n    themeRadiosAndCheckboxes($('body'));\n    watchPaymentFields();\n    // Remove left over elements.\n    $('fieldset.crm-profile-name-name_and_address').remove();\n  }\n  else if (form_name === 'donate') {\n\n    donateAmountLayout();\n    yourInformation();\n    // paymentDetails();\n    giftAid();\n    gdprFields();\n    renameSubmitButton('Donate');\n    themeRadiosAndCheckboxes($('body'));\n    // watchPaymentFields();\n    // Remove left over elements.\n    $('fieldset.crm-profile-name-name_and_address').remove();\n\n  }\n}))(CRM, CRM.$);\n\n"]}