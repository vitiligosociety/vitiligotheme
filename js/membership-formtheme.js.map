{"version":3,"sources":["membership-formtheme.js"],"names":["CRM","$","append","payment_processor_ids","form_name","$form","length","$niceForm","prepend","parseStdCiviField","selector","$rowNode","find","hide","rtn","label","input","parseSelect2CiviField","$select","killSelect2","select2","removeClass","addClass","parseComplexCiviField","parseRadiosIntoSelect","on","prop","each","$originalInput","$option","attr","value","text","next","e","preventDefault","click","$selectFix","createStdFields","$label","fields","$appendTo","$container","buildStdContainer","console","error","yourInformation","a","b","first_name","last_name","email","phone","alterPaymentMethodsAvailable","ethnicitySelect","ethnicityOther","showHideEthnicityOther","val","show","donateAmountLayout","$amount","$blurb","amount","membershipAmountButtons","$priceset","$selectedOption","showButtonAsSelected","$btn","parent","siblings","dataset","$original_input","m","match","vitButton","is","whyJoining","html","$payment_processor_selection_ui","$payment_processor_switch_wrapper","paymentDetails","$paymentDetails","$header","$content","selectPaymentMethod","selected_processor_id","GoCardless","indexOf","giftAid","$gaRow","$inputs","$yes","eq","$yes_label","$no","$no_label","$helpRow","$intro","slice","$declaration","add","remove","$layout","$inputs_container","gdprFields","$gdpr","$niceGdpr","donateOtherComments","c","renameSubmitButton","$submitButtonWrapper","$niceSubmitButton","trigger","$original_billing_payment_block","watchPaymentFields","wrapper","config","childList","subtree","delayed","vitiligoTweakDynamicPaymentFields","observer","disconnect","log","reconfigurePaymentBlock","fadeIn","observe","callback","mutationsList","needToTweakUi","mutation","target","id","window","clearTimeout","setTimeout","MutationObserver","$billingBlock","vtTweaksDone","$billingAddressSection","after","wrap","themeRadiosAndCheckboxes","join","$context","$input","$wrapper","before","donateMovePaymentBlock","findPaymentProcessorRadioForProcessorType","processorType","processorIds","found","allow_dd","vt_payment","ddProcessor"],"mappings":"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","file":"membership-formtheme.js","sourcesContent":["((CRM, $) => $(() => {\n\n'use strict';\n\n  // Bodge for now: @todo\n  $('head').append('<link href=\"https://fonts.googleapis.com/css?family=Arimo\" rel=\"stylesheet\">');\n\n  // The config placeholder here is replaced by php. Do not alter the line below at all.\n  var payment_processor_ids = {};//%config%\n  var form_name = '';//%formname%\n\n  var $form = $('form#Main');\n  if (!$form.length) {\n    return;\n  }\n\n  const $niceForm = $('<div/>');\n  $form.prepend($niceForm);\n\n  function parseStdCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n\n    const rtn = {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content input'),\n    };\n    if (rtn.input.length === 0) {\n      rtn.input = $rowNode.find('div.content textarea');\n    }\n    return rtn;\n  }\n  function parseSelect2CiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    var $select = $rowNode.find('select');\n    return {\n      label: $rowNode.find('div.label label'),\n      input: killSelect2($select)\n    };\n  }\n  function killSelect2($select) {\n    return $('<div class=\"vt-select-container\"/>').append(\n      $select.select2('destroy').removeClass('crm-select2 crm-chain-select-target crm-form-select').addClass('vt-select')\n    );\n  }\n  function parseComplexCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content').removeClass('content'),\n    };\n  }\n  function parseRadiosIntoSelect(selector) {\n    var $rowNode = $form.find(selector).hide();\n    const $select = $('<select class=\"vt-select\" />');\n    $select.append(\n      $('<option value=\"\">--Please select--</option>')\n      .on('click', function() { $rowNode.find('input:checked').prop('checked', false); }));\n    $rowNode.find('input[type=\"radio\"]').each(function() {\n      const $originalInput = $(this);\n      $option = $('<option/>').attr('value', this.value).text($originalInput.next('label').text())\n      .on('click', e => { e.preventDefault(); $originalInput.click(); } );\n      $select.append($option);\n    });\n\n    const $selectFix = $('<div class=\"vt-select-container\" />').append($select);\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $selectFix,\n    };\n  }\n  function createStdFields($label, fields, $appendTo) {\n    const $container = buildStdContainer($label, fields);\n    $niceForm.append($container);\n  }\n  function buildStdContainer($label, fields) {\n    const $container = $('<div class=\"vt-container vt-grid1\"></div>');\n\n    if ($label) {\n      $container.append($('<div class=\"vt-label vt-col-1 vt-colspan-1\"></div>').append($label));\n    }\n\n    if (fields.length === 1) {\n      $container.append($('<div class=\"vt-input vt-col-2-span-2\"></div>').append(fields[0]));\n    }\n    else if (fields.length === 2) {\n      $container.append($('<div class=\"vt-input vt-col-2\"></div>').append(fields[0]));\n      $container.append($('<div class=\"vt-input vt-col-3\"></div>').append(fields[1]));\n    }\n    else {\n      console.error(\"fields must be 1 or two big.\", fields);\n    }\n    return $container;\n  }\n\n  function yourInformation() {\n    var a, b;\n    $niceForm.append('<div class=\"vt-your-info\"><h2>Your information</h2><span>*Required fields</span></div>');\n\n    // Add name fields.\n    var first_name = parseStdCiviField('#editrow-first_name');\n    first_name.label.text('Full Name');\n    first_name.input.attr('placeholder', 'First name');\n    var last_name = parseStdCiviField('#editrow-last_name');\n    last_name.input.attr('placeholder', 'Last name');\n    createStdFields(first_name.label, [first_name.input, last_name.input]);\n\n    // Add email\n    var email = parseStdCiviField('#editrow-email-1, #editrow-email-Primary');\n    email.input.attr('placeholder', 'Email');\n    createStdFields(email.label, [email.input]);\n\n    // Add phone\n    var phone = parseStdCiviField('#editrow-phone-Primary-1');\n    phone.input.attr('placeholder', 'Phone number');\n    phone.label.text('Phone number');\n    createStdFields(phone.label, [phone.input]);\n\n    // address.\n    $niceForm.append('<hr/>');\n    a = parseStdCiviField('#editrow-street_address-Primary');\n    a.label.text('Your address');\n    a.input.attr('placeholder', 'Address line 1*');\n    createStdFields(a.label, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-supplemental_address_1-Primary');\n    a.input.attr('placeholder', 'Address line 2*');\n    createStdFields(null, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-city-Primary');\n    a.input.attr('placeholder', 'Town/City');\n    b = parseSelect2CiviField('#editrow-state_province-Primary');\n    createStdFields(null, [a.input, b.input]);\n    // ...\n    a = parseStdCiviField('#editrow-postal_code-Primary');\n    a.input.attr('placeholder', 'Postcode*');\n    b = parseSelect2CiviField('#editrow-country-Primary');\n    createStdFields(null, [a.input, b.input]);\n    // We also need to hook up the country selector to the payment selector logic.\n    b.input.find('select').on('change', alterPaymentMethodsAvailable);\n\n\n    $niceForm.append('<hr/>');\n    // DOB\n    a = parseComplexCiviField('#editrow-birth_date');\n    a.input.find('.crm-clear-link').hide();\n    createStdFields(a.label, [a.input, null]);\n\n    // Ethnicity\n    var ethnicitySelect = parseSelect2CiviField('#editrow-custom_14');\n    var ethnicityOther = parseStdCiviField('#editrow-custom_15');\n    function showHideEthnicityOther() {\n      if (ethnicitySelect.input.find('select').val() == 18) {\n        ethnicityOther.input.show();\n      }\n      else {\n        ethnicityOther.input.hide().find('input').val(\"\");\n      }\n    }\n    ethnicitySelect.input.on('change', showHideEthnicityOther);\n    ethnicityOther.input.attr('placeholder', 'Other');\n    createStdFields(ethnicitySelect.label, [ethnicitySelect.input, ethnicityOther.input]);\n    showHideEthnicityOther();\n\n    a = parseRadiosIntoSelect('#editrow-gender_id');\n    createStdFields(a.label, [a.input, null]);\n\n    // Do you have Vitiligo.\n    a = parseRadiosIntoSelect('#editrow-custom_16');\n    createStdFields(a.label, [a.input, null]);\n\n  }\n  function donateAmountLayout() {\n    const $container = $('<div class=\"vt-container vt-donation-layout\"></div>');\n    const $amount = $('<div class=\"vt-donation-amount-wrapper\"></div>');\n    const $blurb = $(`<div class=\"vt-donation-amount-blurb\">\n      <div class=\"vt-donation-amount-blurb-header\">\n        <div class=\"vt-donation-blurb-title\">\n          <i class=\"vt-icon vt-icon--member\"></i>\n          Membership is the best way to support us\n        </div>\n        <a class=\"vt-donation-blurb-readmore\" href=\"/membership\" >Read more</a>\n      </div>\n      <div class=\"vt-donation-amount-blurb-text\">\n        <p>We are grateful for all contributions made to The Vitiligo Society\n        to help support our cause. Consider becoming a member to get the latest\n        Vitiligo news straight to your inbox, access premium content, early\n        bird registration to conferences and events, and special discounts with our\n        great partners.</p>\n      </div>\n    </div>`);\n    const amount = parseStdCiviField('.other_amount-section');\n    $amount.append('<h3 class=\"vt-heading\" >Your donation</h3>',\n      amount.label.text('I would like to give'),\n      $('<div class=\"vt-donation-amount-input-wrapper\"/>').append(amount.input)\n      );\n    $container.append($amount, $blurb);\n    $niceForm.append($container);\n  }\n  function membershipAmountButtons() {\n    var a, b;\n    var $priceset = $('#priceset').hide();\n    const $container = $('<div class=\"vt-container vt-amount-buttons\"></div>');\n    var $selectedOption;\n    function showButtonAsSelected($btn) {\n      $btn.addClass('selected').parent().siblings().find('button').removeClass('selected');\n    }\n    $priceset.find('input[data-amount]').each(function() {\n      var amount = this.dataset.amount;\n      const $original_input=$(this);\n      // Reformat amount.\n      var m = amount.match(/(\\d+)(?:(\\.\\d\\d)0*)?$/);\n      if (!m) return;\n\n      // @todo remove this, it's just while we apparently need to keep the £26 option\n      // but not display it.\n      if (m[1] === '26') return;\n\n      if (m[2] === '.00') m[2] = '';\n\n      const $btn = $('<button/>')\n        .text(m[1]+m[2])\n        .on('click', function(e) {\n          e.preventDefault();\n          $original_input.click();\n          showButtonAsSelected($original_input);\n        });\n      // Save a reference to the button on the input.\n      $original_input[0].vitButton = $btn;\n\n      $container.append(\n        $('<div class=\"vt-amount-buttons__button\"></div>')\n        .append($btn)\n      );\n      if ($original_input.is(':checked')) {\n        $selectedOption= $btn;\n      }\n    });\n    if (!$selectedOption) {\n      // Pre-select the 2nd option if no option selected.\n      $selectedOption = $priceset.find('input[data-amount]')[1].vitButton;\n    }\n    // Initial show selected button.\n    showButtonAsSelected($selectedOption);\n\n    $niceForm.append('<h3 class=\"vt-heading vt-heading--smaller-grey1\">My contribution</h3>');\n    $niceForm.append($container);\n    $niceForm.append('<hr/>');\n  }\n  function whyJoining() {\n    var a, b;\n    a = parseStdCiviField('#editrow-custom_17');\n    a.label.html(\"<h3 class='vt-heading'>Why are you signing up to membership with the Vitiligo Society?</h3>\");\n    $niceForm.append($('<div class=\"vt-container\"/>').append(a.label, a.input), '<hr/>');\n  }\n  const $payment_processor_selection_ui = $form.find(\"fieldset.payment_options-group\");\n  var $payment_processor_switch_wrapper; // set in paymentDetails()\n  function paymentDetails() {\n    $payment_processor_selection_ui.hide();\n\n    const $paymentDetails = $('<div class=\"vt-payment-box\"/>');\n    const $header = $(`<div class=\"vt-payment-box__header\">\n      <div class=\"vt-payment-box__gbp\"><i class=\"vt-icon vt-icon--gbp-circle\"></i></div>\n      <h3 class=\"vt-payment-box__heading\">Your payment details</h3>\n      <div class=\"vt-payment-box__payby\">Pay by:</div>\n      <div class=\"vt-payment-box__switch-container\">\n        <div class=\"vt-payment-box__switch-wrapper\">\n          <label class=\"vt-payment-box__dd\" for=\"CIVICRM_QFID_11_payment_processor_id\">Direct Debit</label>\n          <label class=\"vt-payment-box__c\" for=\"CIVICRM_QFID_9_payment_processor_id\">Card</label>\n        </div>\n      </div>\n      `);\n    const $content = $('<div class=\"vt-payment-box__content\"/>');\n    $payment_processor_switch_wrapper = $header.find('.vt-payment-box__switch-wrapper');\n    $paymentDetails.append($header, $content);\n    $content.append($form.find('#billing-payment-block'));\n    $payment_processor_selection_ui.find('input').on('click', selectPaymentMethod);\n    $payment_processor_switch_wrapper.find('label').on('click', selectPaymentMethod);\n    $niceForm.append($paymentDetails);\n    alterPaymentMethodsAvailable();\n    selectPaymentMethod();\n  }\n  function selectPaymentMethod() {\n    const selected_processor_id = $payment_processor_selection_ui.find('input:checked').val();\n\n    // Card selected if we dno't have a choice. (Donate page)\n    if (typeof(selected_processor_id) === 'undefined') {\n      $payment_processor_switch_wrapper.addClass('selected-c').removeClass('selected-dd');\n      return;\n    }\n\n    if (payment_processor_ids.GoCardless.indexOf(selected_processor_id) > -1) {\n      $payment_processor_switch_wrapper.addClass('selected-dd').removeClass('selected-c');\n    }\n    else {\n      $payment_processor_switch_wrapper.addClass('selected-c').removeClass('selected-dd');\n    }\n  }\n  function giftAid() {\n    //editrow-custom_10\n    const $gaRow = $('#editrow-custom_10');\n    const $inputs = $gaRow.find('input');\n    const $yes = $inputs.eq(0);\n    const $yes_label = $yes.next();\n    const $no = $inputs.eq(1);\n    const $no_label = $no.next();\n    const $helpRow = $('#helprow-custom_10>div');\n    const $intro = $helpRow.find('>p').slice(3,5);\n    const $declaration = $helpRow.find('p').eq(0).add($helpRow.find('ol').eq(0));\n\n    // Remove the remaining help text.\n    $helpRow.remove();\n\n    // Remove the third input (\"Yes, in the past 4 years\")\n    $inputs.eq(2).parent().parent().remove();\n\n    // Now re-assemble.\n    const $container = $('<div class=\"vt-container\"></div>');\n    $container.append('<h3 class=\"vt-heading\">Gift Aid</h3>', $intro);\n    // Now the grid layout\n    const $layout = $('<div class=\"vt-giftaid-layout-1\"/>');\n    const $inputs_container = $('<div class=\"vt-giftaid-inputs\" />');\n    $inputs_container.append($yes, $yes_label, $no, $no_label);\n    $layout.append($inputs_container, $('<div class=\"vt-giftaid-declaration\"/>').append($declaration));\n    $container.append($layout);\n    $niceForm.append($container, '<hr/>');\n\n  }\n  function gdprFields() {\n    const $gdpr = $('#gdpr-terms-conditions');\n    const $niceGdpr = $('<div class=\"vt-gdpr\"></div>');\n    $niceGdpr.append($('<div class=\"vt-gdpr__text\"/>').append('<h2>Terms and conditions</h2>', $gdpr.find('.terms-conditions-acceptance-intro')));\n\n    $niceGdpr.append($gdpr.find('.terms-conditions-item'));\n\n    $niceForm.append($niceGdpr);\n    $gdpr.remove();\n  }\n  function donateOtherComments() {\n    const c = parseStdCiviField('#editrow-custom_17');\n    $niceForm.append(\n      $('<div class=\"vt-container vt-donate-other-comment\"/>')\n      .append(\n        c.label.text('Any other comments?'),\n        c.input.attr('placeholder', 'Type here...'))\n    );\n  }\n  function renameSubmitButton(text) {\n    // Hide the original button, make a new button which clicks it by JS.\n    const $submitButtonWrapper = $form.find('#crm-submit-buttons input').parent().hide();\n\n    const $niceSubmitButton = $('<button class=\"vt-submit\"/>')\n      .text(text)\n      .on('click', e => {e.preventDefault();$submitButtonWrapper.find('input[type=\"submit\"]').trigger('click');});\n\n    $niceForm.append($niceSubmitButton);\n  }\n  /**\n   * We need to look out for changes that are interactively made by CiviCRM.\n   */\n  // CiviCRM ends up creating nested versions of this :-(\n  // So make a reference to the original.\n  const $original_billing_payment_block = $('#billing-payment-block');\n  function watchPaymentFields() {\n    const wrapper = $original_billing_payment_block[0];\n    const config = { childList: true, subtree: true };\n    var delayed = false;\n\n    // This function deals with re-presenting card payment fields in the billing-payment-block\n    const vitiligoTweakDynamicPaymentFields = function() {\n      observer.disconnect();\n      console.log(\"Tweaking form ...\");\n      reconfigurePaymentBlock();\n      console.log(\"End tweaks. Showing payment block again and reconnecting observer\");\n      $original_billing_payment_block.fadeIn('fast');\n      observer.observe(wrapper, config);\n    };\n\n    // This callback is used in the mutation observer.\n    // Its job is to identify if a DOM mutation is relevant to the billing payment block.\n    // If so it will call vitiligoTweakDynamicPaymentFields after half a second.\n    const callback = function(mutationsList, observer) {\n      var needToTweakUi = false;\n      for(var mutation of mutationsList) {\n\t\t\t\t// We need to detect whether the change was the payment block.\n\t\t\t\tif (mutation.target.id == 'billing-payment-block') {\n          needToTweakUi = true;\n\t\t\t\t}\n      }\n\n      if (needToTweakUi) {\n        console.log(\"Found billing-payment-block in mutation targets\", mutationsList);\n        // Note CiviCRM ends up creating nested #billing-payment-block elements :-(\n\n        // Hide the element while we build this and mess it around.\n        $original_billing_payment_block.hide();\n\n        // If already queued, requeue with new delay.\n        if (delayed) {\n          window.clearTimeout(delayed);\n          delayed = false;\n        }\n        // Allow some time for things to settle.\n        delayed = window.setTimeout(vitiligoTweakDynamicPaymentFields, 500);\n      }\n    };\n\n    // Create an observer instance linked to the callback function\n    const observer = new MutationObserver(callback);\n\n    // Start observing the target node for configured mutations\n    observer.observe(wrapper, config);\n  }\n  function reconfigurePaymentBlock() {\n    // Reconfigure payment block.\n    // Remove the non-unique id from the billing-payment-block.\n    $original_billing_payment_block.find('#billing-payment-block').attr('id', 'nested-billing-payment-block');\n    const $billingBlock = $original_billing_payment_block;\n    if ($billingBlock[0].vtTweaksDone) {\n      console.log(\"Already tweaked it.\");\n    }\n    $billingBlock[0].vtTweaksDone = true;\n    // We'll use this existing container for the address fields.\n    const $billingAddressSection = $billingBlock.find('.billing_name_address-section');\n\n    $billingBlock.find('.credit_card_number-section').after(\n      $('<div class=\"direct-debit-benefits-para\"><div class=\"dashed\" ><i class=\"vt-icon vt-icon--info\"></i>If you have a UK bank account please consider using Direct Debit, we are charged a lesser fee and more of your money goes to supporting those with Vitiligo.</div><i class=\"vt-icon vt-icon--padlock\"></i></div>')\n    );\n    // Strip out some CiviCRM classes that give us grief.\n    $billingBlock.find('.crm-section').removeClass('crm-section');\n    $billingBlock.find('div.label').removeClass('label').addClass('vt-payment-label');\n    $billingBlock.find('div.content').removeClass('content').addClass('vt-container');\n    $billingBlock.find('.clear').remove();\n\n\n    // Re-class the selects.\n    $billingBlock.find('#credit_card_exp_date_M, #credit_card_exp_date_Y')\n      .addClass('vt-select')\n      .wrap('<div class=\"vt-select-container vt-card-expiry\"/>');\n\n    // If we have a billingAddressSection we need to theme that now.\n    if ($billingAddressSection.length) {\n      // ... add a title and move the 'same as above' checkbox.\n      $billingAddressSection.append('<h2>Your billing information</h2>',\n        $billingBlock.find('#billingcheckbox'),\n        $billingBlock.find('label[for=\"billingcheckbox\"]')\n      );\n      // Theme the \"My billing address is same...\"\n      themeRadiosAndCheckboxes($billingAddressSection);\n\n      // Move the Name fields.\n      $billingAddressSection.append(buildStdContainer(\n        $billingBlock.find('.billing_first_name-section label').text('Name on card'),\n        [\n          $billingBlock.find('.billing_first_name-section input'),\n          $billingBlock.find('.billing_last_name-section input'),\n        ]\n      ));\n\n      // Move Street addres.,\n      $billingAddressSection.append(buildStdContainer(\n        $billingBlock.find('.billing_street_address-5-section label').text('Address'),\n        [$billingBlock.find('.billing_street_address-5-section input').attr('placeholder', 'Address line 1*')]\n      ));\n\n      // Move City., county.\n      $billingAddressSection.append(buildStdContainer(\n        null,\n        [\n          $billingBlock.find('.billing_city-5-section input').attr('placeholder', 'Town/City'),\n          killSelect2($billingBlock.find('.billing_state_province_id-5-section select'))\n        ]\n      ));\n\n      // Move Post code, country.\n      $billingAddressSection.append(buildStdContainer(\n        null,\n        [\n          $billingBlock.find('.billing_postal_code-5-section input').attr('placeholder', 'Postcode'),\n          killSelect2($billingBlock.find('.billing_country_id-5-section select'))\n        ]\n      ));\n\n      // Hide left over crud.\n      $billingBlock.find([\n        '.billing_first_name-section',\n        '.billing_middle_name-section',\n        '.billing_last_name-section',\n        '.billing_street_address-5-section',\n        '.billing_city-5-section',\n        '.billing_state_province_id-5-section',\n        '.billing_postal_code-5-section',\n        '.billing_country_id-5-section',\n      ].join(',')).hide();\n    }\n\n  }\n  function themeRadiosAndCheckboxes($context) {\n    $context.find('input[type=\"radio\"], input[type=\"checkbox\"]').each(function() {\n      const $input = $(this);\n      if ($input.is('.vt-themed')) {\n        return;\n      }\n      const $label = $input.next();\n      const $wrapper = $('<div class=\"vt-checkbox-radio-wrapper\"/>');\n      if ($input.is('input[type=\"checkbox\"]')) {\n        $wrapper.addClass('checkbox');\n      }\n      else {\n        $wrapper.addClass('radio');\n      }\n      $input.before($wrapper);\n      $wrapper.append($input, $label);\n      $input.addClass('vt-themed');\n    });\n  }\n  function donateMovePaymentBlock() {\n    reconfigurePaymentBlock();\n  }\n  // Returns DOM node.\n  function findPaymentProcessorRadioForProcessorType(processorType) {\n    var processorIds = payment_processor_ids[processorType] || [];\n\n    var found;\n    $('fieldset.payment_options-group [name=\"payment_processor_id\"]').each(function() {\n      var m =this.id.match(/CIVICRM_QFID_(\\d+)_payment_processor_id$/);\n      if (m && m.length === 2 && processorIds.indexOf(m[1])>-1) {\n        found = this;\n      }\n    });\n\n    return found;\n  }\n  function alterPaymentMethodsAvailable() {\n\n    var allow_dd = false;\n\n    const selected_processor_id = $form.find('fieldset.payment_options-group input:checked').val();\n    if (form_name === 'membership') {\n      // Membership. Allow DD if in uk.\n      allow_dd = 'United Kingdom' === $('#country-Primary option:selected').text();\n    }\n\n    const vt_payment = $('.vt-payment-box');\n    const ddProcessor = $(findPaymentProcessorRadioForProcessorType('GoCardless'));\n\n    if (allow_dd) {\n      // Allow DD and Card.\n      vt_payment.removeClass('disable-dd');\n    }\n    else {\n      // Disable DD payments.\n      vt_payment.addClass('disable-dd');\n      // If currently selected processor is DD then do the change now.\n      if (ddProcessor.is(':checked')) {\n        // Need to change it.\n        $(findPaymentProcessorRadioForProcessorType('Stripe')).click();\n        selectPaymentMethod();\n      }\n    }\n    // Now disable DD radio input unless in uk.\n    // This is done for accessibility reasons - visual users will already not\n    // have a way to select those.\n    $(ddProcessor).prop('disabled', !allow_dd);\n  }\n\n  if (form_name === 'membership') {\n\n    $niceForm.addClass('vt-membership-form');\n    membershipAmountButtons();\n    yourInformation();\n    whyJoining();\n    paymentDetails();\n    giftAid();\n    gdprFields();\n    renameSubmitButton('Join');\n    themeRadiosAndCheckboxes($('body'));\n    watchPaymentFields();\n    // Remove left over elements.\n    $('fieldset.crm-profile-name-name_and_address').remove();\n  }\n  else if (form_name === 'donate') {\n\n    $niceForm.addClass('vt-donate-form');\n    donateAmountLayout();\n    yourInformation();\n    giftAid();\n    donateOtherComments();\n    paymentDetails();\n    donateMovePaymentBlock();\n    gdprFields();\n    renameSubmitButton('Donate');\n    themeRadiosAndCheckboxes($('body'));\n    // Remove left over elements.\n    $('fieldset.crm-profile-name-name_and_address, fieldset.crm-profile-name-supporter_profile').remove();\n\n  }\n}))(CRM, CRM.$);\n\n"]}