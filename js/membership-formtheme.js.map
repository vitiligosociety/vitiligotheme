{"version":3,"sources":["membership-formtheme.js"],"names":["CRM","$","payment_processor_ids","console","log","$form","length","$niceForm","prepend","parseStdCiviField","selector","$rowNode","find","hide","rtn","label","input","parseSelect2CiviField","$select","select2","removeClass","addClass","append","parseComplexCiviField","parseRadiosIntoSelect","on","prop","each","$originalInput","$option","attr","value","text","next","e","preventDefault","click","$selectFix","createStdFields","$label","fields","$container","error","yourInformation","a","b","first_name","last_name","email","phone","membershipAmountButtons","$priceset","map","forEach","m","parent","siblings","whyJoining","html","paymentDetails","$paymentDetails","$header","$content","$wrapper","selectPaymentMethod","selected_processor_id","val","GoCardless","indexOf","giftAid","$gaRow","$inputs","$yes","eq","$yes_label","$no","$no_label","$helpRow","$intro","slice","$declaration","add","$layout","$inputs_container","updateUi","$inUK","is","$payment_processor","fadeIn","selectPaymentProcessor","updatePaymentProcessorNames","processorType","found","processorIds","id","match","trigger","gcText","stripeText","Stripe","before","$div","appendTo","name","type","$notInUK","$payment_options","overridePriceSetShowHide","setTimeout"],"mappings":"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","file":"membership-formtheme.js","sourcesContent":["((CRM, $) => $(() => {\n\n'use strict';\n\n  // The config placeholder here is replaced by php. Do not alter the line below at all.\n  var payment_processor_ids = {};//%config%\n  console.log(payment_processor_ids);\n\n  var $form = $('form#Main');\n  if (!$form.length) {\n    return;\n  }\n\n  const $niceForm = $('<div/>');\n\n  $form.prepend($niceForm);\n\n  function parseStdCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n\n    const rtn = {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content input'),\n    };\n    if (rtn.input.length === 0) {\n      rtn.input = $rowNode.find('div.content textarea');\n    }\n    return rtn;\n  }\n  function parseSelect2CiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    var $select = $rowNode.find('select').select2('destroy').removeClass('crm-select2 crm-chain-select-target crm-form-select').addClass('vt-select');\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $('<div class=\"vt-select-container\"/>').append($select),\n    };\n  }\n  function parseComplexCiviField(selector) {\n    var $rowNode = $form.find(selector).hide();\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $rowNode.find('div.content').removeClass('content'),\n    };\n  }\n  function parseRadiosIntoSelect(selector) {\n    var $rowNode = $form.find(selector).hide();\n    const $select = $('<select class=\"vt-select\" />');\n    $select.append(\n      $('<option value=\"\">--Please select--</option>')\n      .on('click', function() { $rowNode.find('input:checked').prop('checked', false); }));\n    $rowNode.find('input[type=\"radio\"]').each(function() {\n      const $originalInput = $(this);\n      $option = $('<option/>').attr('value', this.value).text($originalInput.next('label').text())\n      .on('click', e => { e.preventDefault(); $originalInput.click(); } );\n      $select.append($option);\n    });\n\n    const $selectFix = $('<div class=\"vt-select-container\" />').append($select);\n    return {\n      label: $rowNode.find('div.label label'),\n      input: $selectFix,\n    };\n  }\n  function createStdFields($label, fields) {\n    const $container = $('<div class=\"vt-container vt-grid1\"></div>');\n\n    if ($label) {\n      $container.append($('<div class=\"vt-label vt-col-1 vt-colspan-1\"></div>').append($label));\n    }\n\n    if (fields.length === 1) {\n      $container.append($('<div class=\"vt-input vt-col-2-span-2\"></div>').append(fields[0]));\n    }\n    else if (fields.length === 2) {\n      $container.append($('<div class=\"vt-input vt-col-2\"></div>').append(fields[0]));\n      $container.append($('<div class=\"vt-input vt-col-3\"></div>').append(fields[1]));\n    }\n    else {\n      console.error(\"fields must be 1 or two big.\", fields);\n    }\n    $niceForm.append($container);\n  }\n\n  function yourInformation() {\n    var a, b;\n    $niceForm.append('<div class=\"vt-your-info\"><h2>Your information</h2><span>*Required fields</span></div>');\n\n    // Add name fields.\n    var first_name = parseStdCiviField('#editrow-first_name');\n    first_name.label.text('Full Name');\n    first_name.input.attr('placeholder', 'First name');\n    var last_name = parseStdCiviField('#editrow-last_name');\n    last_name.input.attr('placeholder', 'Last name');\n    createStdFields(first_name.label, [first_name.input, last_name.input]);\n\n    // Add email\n    var email = parseStdCiviField('#editrow-email-1');\n    email.input.attr('placeholder', 'Email');\n    createStdFields(email.label, [email.input]);\n\n    // Add phone\n    var phone = parseStdCiviField('#editrow-phone-Primary-1');\n    phone.input.attr('placeholder', 'Phone number');\n    phone.label.text('Phone number');\n    createStdFields(phone.label, [phone.input]);\n\n    // address.\n    $niceForm.append('<hr/>');\n    a = parseStdCiviField('#editrow-street_address-Primary');\n    a.label.text('Your address');\n    a.input.attr('placeholder', 'Address line 1*');\n    createStdFields(a.label, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-supplemental_address_1-Primary');\n    a.input.attr('placeholder', 'Address line 2*');\n    createStdFields(null, [a.input]);\n    // ...\n    a = parseStdCiviField('#editrow-city-Primary');\n    a.input.attr('placeholder', 'Town/City');\n    b = parseSelect2CiviField('#editrow-state_province-Primary');\n    createStdFields(null, [a.input, b.input]);\n    // ...\n    a = parseStdCiviField('#editrow-postal_code-Primary');\n    a.input.attr('placeholder', 'Postcode*');\n    b = parseSelect2CiviField('#editrow-country-Primary');\n    // b.input.find('select').select2('destroy');\n    createStdFields(null, [a.input, b.input]);\n\n    $niceForm.append('<hr/>');\n    // DOB\n    a = parseComplexCiviField('#editrow-birth_date');\n    a.input.find('.crm-clear-link').hide();\n    createStdFields(a.label, [a.input, null]);\n\n    // Ethnicity\n    a = parseSelect2CiviField('#editrow-custom_14');\n    b = parseStdCiviField('#editrow-custom_15');\n    b.input.attr('placeholder', 'Other'); // Q. how to be reactive to an existing select2 element? @todo\n    createStdFields(a.label, [a.input, b.input]);\n\n    a = parseRadiosIntoSelect('#editrow-gender_id');\n    createStdFields(a.label, [a.input, null]);\n\n    // Do you have Vitiligo.\n    a = parseRadiosIntoSelect('#editrow-custom_16');\n    createStdFields(a.label, [a.input, null]);\n\n  }\n  function membershipAmountButtons() {\n    var a, b;\n    var $priceset = $('#priceset').hide();\n    const map = [\n      ['#price_7_a', '£50'],\n      ['#price_7_7', '£25'],\n      ['#price_7_b', '£100'],\n      ['#price_7_c', '£200'],\n      ['#price_7_d', '£500'],\n    ];\n    const $container = $('<div class=\"vt-container vt-amount-buttons\"></div>');\n    map.forEach(m => {\n      $container.append(\n        $('<div class=\"vt-amount-buttons__button\"></div>')\n        .append($('<button/>')\n          .text(m[1])\n          .on('click', function(e) {\n            e.preventDefault();\n            $(m[0]).click();\n            $(this).addClass('selected').parent().siblings().find('button').removeClass('selected');\n          })\n        )\n      );\n    });\n\n    $niceForm.append('<h3 class=\"vt-heading\">My contribution</h3>');\n    $niceForm.append($container);\n    $niceForm.append('<div>Annual membership renews automatically, can be cancelled upto 14 days before renewal date</div>');\n    $niceForm.append('<hr/>');\n  }\n  function whyJoining() {\n    var a, b;\n    a = parseStdCiviField('#editrow-custom_17');\n    a.label.html(\"<h3 class='vt-heading'>Why are you signing up to membership with the Vitiligo Society?</h3>\");\n    $niceForm.append($('<div class=\"vt-container\"/>').append(a.label, a.input), '<hr/>');\n  }\n  function paymentDetails() {\n    const $originalInput = $form.find(\"fieldset.payment_options-group\").hide();\n\n    const $paymentDetails = $('<div class=\"vt-payment-box\"/>');\n    const $header = $(`<div class=\"vt-payment-box__header\">\n      <h3 class=\"vt-payment-box__heading\">Your payment details</h3>\n      <div class=\"vt-payment-box__payby\">Pay by:</div>\n      <div class=\"vt-payment-box__switch-container\">\n        <div class=\"vt-payment-box__switch-wrapper\">\n          <label class=\"vt-payment-box__dd\" for=\"CIVICRM_QFID_11_payment_processor_id\">Direct Debit</label>\n          <label class=\"vt-payment-box__c\" for=\"CIVICRM_QFID_9_payment_processor_id\">Card</label>\n        </div>\n      </div>\n      `);\n    const $content = $('<div class=\"vt-payment-box__content\"/>');\n    $paymentDetails.append($header, $content);\n    $content.append($form.find('#billing-payment-block'));\n    const $wrapper = $header.find('.vt-payment-box__switch-wrapper');\n\n    function selectPaymentMethod() {\n      const selected_processor_id = $originalInput.find('input:checked').val();\n      console.log(\"selectPaymentMethod running \", selected_processor_id);\n      if (payment_processor_ids.GoCardless.indexOf(selected_processor_id) > -1) {\n        $wrapper.addClass('selected-dd').removeClass('selected-c');\n      }\n      else {\n        $wrapper.addClass('selected-c').removeClass('selected-dd');\n      }\n    }\n\n    $originalInput.find('input').on('click', selectPaymentMethod);\n    $wrapper.find('label').on('click', selectPaymentMethod);\n    $niceForm.append($paymentDetails);\n    selectPaymentMethod();\n  }\n  function giftAid() {\n    //editrow-custom_10\n    const $gaRow = $('#editrow-custom_10');\n    const $inputs = $gaRow.find('input');\n    const $yes = $inputs.eq(0);\n    const $yes_label = $yes.next();\n    const $no = $inputs.eq(1);\n    const $no_label = $no.next();\n    const $helpRow = $('#helprow-custom_10>div');\n    const $intro = $helpRow.find('>p').slice(3,5);\n    const $declaration = $helpRow.find('p').eq(0).add($helpRow.find('ol').eq(0));\n\n    // Now re-assemble.\n    const $container = $('<div class=\"vt-container\"></div>');\n    $container.append('<h3 class=\"vt-heading\">Gift Aid</h3>', $intro);\n    // Now the grid layout\n    const $layout = $('<div class=\"vt-giftaid-layout-1\"/>');\n    const $inputs_container = $('<div class=\"vt-giftaid-inputs\" />');\n    $inputs_container.append($yes, $yes_label, $no, $no_label);\n    $layout.append($inputs_container, $('<div class=\"vt-giftaid-declaration\"/>').append($declaration));\n    $container.append($layout);\n    $niceForm.append($container, '<hr/>');\n\n  }\n\n  membershipAmountButtons();\n  yourInformation();\n  whyJoining();\n  paymentDetails();\n  giftAid();\n  return;\n\n  // Create UK radios.\n  function updateUi() {\n    if ($inUK.is(\":checked\")) {\n      // Show all options.\n      $payment_processor.fadeIn('fast');\n      // Nudge user to GoCardless.\n      selectPaymentProcessor('GoCardless');\n      updatePaymentProcessorNames('Direct Debit - more of your money goes to the Vitiligo Society', 'Recurring credit/debit card payment');\n    }\n    else {\n      // Select Stripe.\n      $payment_processor.hide(); // Normally hidden anyway, but just in case user changes mind on UKness.\n      // Force user to use Stripe; GC not relevant outside UK.\n      selectPaymentProcessor('Stripe');\n      updatePaymentProcessorNames('', 'Recurring credit/debit card payment');\n    }\n  }\n\n  /**\n   * Find and click the input for either 'stripe' or 'gocardless' payment\n   * processor based on configured Payment Processor Ids.\n   */\n  function selectPaymentProcessor(processorType) {\n    var found;\n    var processorIds = payment_processor_ids[processorType] || [];\n\n    $payment_processor.find('[name=\"payment_processor_id\"]').each(function() {\n      var m =this.id.match(/CIVICRM_QFID_(\\d+)_payment_processor_id$/);\n      if (m && m.length === 2 && processorIds.indexOf(m[1])>-1) {\n        found = this;\n      }\n    });\n\n    $(found).trigger('click');\n  }\n  /**\n   * Update hints on the processor names.\n   */\n  function updatePaymentProcessorNames(gcText, stripeText) {\n    $payment_processor.find('[name=\"payment_processor_id\"]').each(function() {\n      var m =this.id.match(/CIVICRM_QFID_(\\d+)_payment_processor_id$/);\n      if (m && m.length === 2) {\n        // Got processor ID. Is it stripe or GoCardless?\n        if (payment_processor_ids.GoCardless.indexOf(m[1]) > -1) {\n          // GoCardless.\n          $(this).next().text(gcText);\n\n        }\n        else if (payment_processor_ids.Stripe.indexOf(m[1]) > -1) {\n          // Stripe.\n          $(this).next().text(stripeText);\n        }\n\n        if ($(this).next().next().prop('tagName') !== 'BR') {\n          // Insert line break before input.\n          $(this).next().next().before('<br/>');\n        }\n      }\n    });\n\n  }\n\n  // Copy CiviCRM's default HTML structure.\n  var $container = $('<div/>').addClass('crm-public-form-item crm-section');\n  $container.append($('<div/>').addClass('label'));\n  var $div = $('<div/>').addClass('content').appendTo($container);\n  $container.append($('<div/>').addClass('clear'));\n\n  var $inUK = $('<input/>')\n    .attr({id: 'in-uk-yes', value: '1', name: 'in-uk', type:'radio'})\n    .on('click', updateUi)\n    .appendTo($div);\n  $('<label/>')\n    .attr('for', 'in-uk-yes')\n    .text(\"I'm in the UK\")\n    .appendTo($div);\n  var $notInUK = $('<input/>')\n    .attr({id: 'in-uk-no', value: '0', name: 'in-uk', type:'radio'})\n    .on('click', updateUi)\n    .appendTo($div);\n  $('<label/>')\n    .attr('for', 'in-uk-no')\n    .text(\"I'm not in the UK\")\n    .appendTo($div);\n\n\n  var $payment_options = $form.find('.payment_options-group');\n  var $payment_processor = $payment_options.find('.payment_processor-section');\n  $payment_processor.hide().before($container);\n\n\n  // Finally, we need to override CiviCRM's events on the price set selection.\n  function overridePriceSetShowHide() {\n    if (!$inUK.is(':checked') && !$notInUK.is(':checked')) {\n      // Neither UK nor not UK is checked, so hide the other options for now.\n      $payment_processor.hide();\n    }\n  }\n  // Apply this when the price set is clicked.\n  $('.price-set-option-content input[type=\"radio\"]').on('click', function() {\n    overridePriceSetShowHide();\n    // In case we are not called first, repeat this after giving 50ms for other processes to work.\n    setTimeout(overridePriceSetShowHide, 50);\n  });\n\n}))(CRM, CRM.$);\n\n"]}